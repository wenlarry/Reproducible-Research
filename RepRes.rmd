
```
title: "Research on the impact of weather events on Public Health and the economic damages to crops and properties in USA "
author: "wenlarry"
date:  "Septemebr 23, 2016"
output: 
  html_document: 
    toc: yes
```
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,error=TRUE) 

```
SYNOPSIS

An analysis on the impact of severe weather events on public health and the US economy .The data for the analysis and estimates is from the US National Oceanic and Atmospheric Administratin (NOAA)  1950-2011.The analysis covers the period 1991 to Nov 2011 as there are sparse data during the earlier periods. Also the analysis covers only 1) Fatalities of 10 and above 2) Inuries of 20 and above 3) economic damage of $300K and above to crops 4) economic damage of $1M and above to properties, across the USA. The analysis concludes that high national fatalities and injuries had been caused by 'Tornado', 'Flood' and 'Heat'. With regard to the highest economic damages to crops and properties, 'Hurricane, 'Flood' and 'Drought were the major causes. 

DATA PROCESSING

Download and Unzip data in working directory

```{r, data}
data<-read.csv("repdata-data-StormData.csv",stringsAsFactors = FALSE) 

```
Raw Data Processing

Subset only the data from 1991 to Nov 2011 as the data in the earlier years have fewer recorded events. 

Subset only the required columns relating to injuries,fatalities,crop damages and property damages

```{r, message=FALSE, warning=FALSE}
library(dplyr) 
library(ggplot2)
library(cowplot) 

dat2<-slice(data,174582:902297)%>%select(1,2,7,8,23,24,25,26,27,28) 

str(dat2) 

```
A) Data Processing for fatalities and injuries

Subset only where fatalities are 10 and above and injuries of 20 and above caused by weather events

```{r, fatalities, injuries}

datfi<- filter(dat2,FATALITIES>9,INJURIES>19) %>%
        select(1:6) 

summary(datfi) 

```
B) Data Processing for economic damages to crops and properties

Convert the crop and property damages data into comparative numbers

Subset only where the economic damages are $300K for crops and $1M for properties

```{r,crops,properties}
cal<-function(dmg,dmgexp)dmg*switch(toupper(dmgexp),H=100,K=1000,M=1000000,B=1000000000,1) 

dat2$pdmg<-mapply(cal,dat2$PROPDMG,dat2$PROPDMGEXP) 
dat2$cdmg<-mapply(cal,dat2$CROPDMG,dat2$CROPDMGEXP) 

dmgcp<-select(dat2,c(1,3,4,7,9,11,12)   )%>%filter(pdmg>1000000,cdmg>300000) 

summary(dmgcp) 

```
RESULTS

A) Impact on public health with the resultant fatalities and injuries

Tornado, Flood and Heat had caused the most fatalities and injuries 

```{r, fatalities_injuries}
datf<-slice(datfi,c(1,4,25,35,39,2,7,29,10,8,34,15,41,                     20,42) )%>%select(3,4,5) 

head(datf) 

dati<-slice(datfi,c(42,41,39,13,15,18,8,14,19,4,25,32))%>%select(3,4,6) 

head(dati) 
```
Plotting the fatalities and injuries

```{r, fatalities,injuries, echo=FALSE} 
ggplot (datfi, aes(FATALITIES, INJURIES)) + geom_point(color = "red",size = 3,alpha = 1 / 2) + facet_wrap( ~ EVTYPE  ) + labs(title = "Fatalities_Injuries from weather events in USA from 1991 to 2001 ") +    theme_bw()  
                                                       
```

B) Economic damages to crops and properties 

Rename the variables 'pdmg' and 'cdmg' for better presentations

Hurricane and Flood caused the highest economic damages to properties and crops. In addition, Drought had also caused significant economic damage to crops 

```{r, crops and properties damages}
dmgcp2<-rename(dmgcp,Property_damage=pdmg,Crop_damage=cdmg)

dmgp<-slice(dmgcp,c(595,475,419,31,422,424,299,418,19,278) ) %>%select(2,3,6) 

head(dmgp) 

dmgc<-slice(dmgcp,c(31,475,318,299,465,296,280,278,419,271,451,281))%>%select(2,3,7) 

head(dmgc) 

```
Plotting the damages to crops and properties
(Note: scientific numeric notations are used in the plots. This is acceptable for research papers)

```{r, plot crops and property damages,echo=FALSE} 
theme_set(theme_cowplot (font_size=11) )

plotp<-ggplot(dmgcp2,aes(EVTYPE,Property_damage))+geom_bar(stat="identity",fill="orange")  +ylab("Property_damage US$") + xlab("Weather Events in USA from 1991 to 2001") 
 
plotc<-ggplot(dmgcp2,aes(EVTYPE,Crop_damage))+geom_bar(stat="identity",fill= "green") +ylab("Crop_damage US$")+xlab("Weather Events in USA from 1991 to 2001") 

plot_grid(plotp,plotc,labels="auto",align='h',label_size=10,rel_widths=c(1,1.3),scale=0.95) 
 
```
